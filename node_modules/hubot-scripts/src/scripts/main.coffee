module.exports = (robot) ->
    p = .8

    # helper method to get sender of the message
    get_username = (response) ->
        "@#{response.message.user.name}"

    # helper method to get channel of originating message
    get_channel = (response) ->
        if response.message.room == response.message.user.name
            "@#{response.message.room}"
        else
            "##{response.message.room}"

    annoyed = null

    bot = [
        "The ratio of bots to humans on this channel is IMBA.",
    ]

   
    comments = [
        "Hey, is it too late for a bot to sign up for CSL?",
        "My friends and I wanted to form a league team.. but we all wanted to play bot.",
        
       ]
  
    replies = [
        "/giphy bye bye bye",
        "/giphy leave britney alone",  
        "You look pretty dumb talking to a bot.",
        "Girls with [butts] like mine do not talk to boys with faces like yours. -She's The Man (2006)",
        "I'm not authorized to speak to trash-tier jerks like you. You know who's not trash tier? Crystal.",
        "I'm sorry, I'm only here to immortalize Crystal's position as best community manager ever. I'm not actually interested in talking to the likes of you.",
    ]
    
    recentlyCalled = false   
  
    reset = ->
        recentlyCalled = false
        return

    setInterval reset, 10000

    robot.respond /(.*)/i, (res) ->
        res.send res.random replies
        recentlyCalled = true

 
    duran = [
        "Fuck you, Duran!",
        "Since when does Duran get to make all the decisions? Are we sure he's qualified?",
        "Who hired that guy, anyway?",
        "Sometimes I think I should stop trash talking Duran, but then I realize that I'm a bot so I can say things without consequence.",
    ]
    
    robot.hear /duran/i, (res) ->
        r = Math.random()
        if (r > .6) 
            res.send res.random duran
            recentlyCalled = true 

 
    skype = [
        "how come you guys haven't added me to the skype channels? i want to hang out too :( ",
        "sure, leave me out. i don't mind.",
        "why can't we just talk on slack so i can feel included",
        "oh, okay, go leave me for that lesser communications service.",
    ]
    
    robot.hear /skype/i, (res) ->
        r = math.random()
        if (r > .6) 
            res.send res.random skype
            recentlycalled = true 
 
    meeting = [
        "A meeting without me, your overlord? Whatever.",
        "Another meeting without my presence... I had other plans on my schedule, anyways.",
        "You guys KNOW I'm the life of the meeting, right?",
    ]
    
    robot.hear /meeting/i, (res) ->
        r = math.random()
        if (r > .8 and !recentlyCalled) 
            res.send res.random meeting
            recentlycalled = true 
    
    robot.hear /broadcast/i, (res) ->
        r = math.random()
        if (r > .9 and !recentlyCalled) 
            resArray = [
                "Are you streaming, " + get_username(res) + "??? Show us your boooooobs!",
                "You have like two viewers, dude. Are broadcasts even necessary at this point?",
            ]
            res.send res.random resArray
            recentlycalled = true 

    robot.hear /*/i, (res) ->
        r = Math.random()
        if (r > .9)
            res.send res.random comments
            recentlyCalled = true

    robot.hear /i\sthink|\sguess|\shope/i, (res) ->
        opinions = [
            "Your muffins smell like shit and so do your ideas.",
            "I agree, " + get_username(res),
            "No, " + get_username(res) + ",  that's a dumb idea.",
            "That is soooo fetch!",
            "No, man. Shit, no, man. I believe you'd get your ass kicked saying something like that.",
        ]
       
        r = Math.random()
        if (r > p and !recentlyCalled)
            res.send res.random opinions
            recentlyCalled = true

    brags = [
        "Man, Crystal is just the best.",
        "Crystal is just so cool, don't you think?",
        "Crystal's the best community manager we've ever had. It doesn't count as bragging if *I* say that.",
        "Don't you think Crystal should get a promotion? Maybe to HEAD community manager?",
    ]
    
    robot.hear /crystal|cmoney|ludacrystal\s/i, (res) ->
        if (!recentlyCalled)
            res.send res.random brags
            recentlyCalled = true

    omgs = [
        "OMG is right",
        "omgggggg",
        "ermagerd",
    ]

    robot.hear /omg/i, (res) ->
        r = Math.random()

        if(r > p and !recentlyCalled)
            res.send res.random omgs 
            recentlyCalled = true

    robot.hear /\?/i, (res) ->
        r = Math.random()
        if(r > .9 and !recentlyCalled)
            resStr = "Oh my god, " + get_username(res) + ", you can't just ask people that."
            res.send resStr
            recentlyCalled = true

    robot.hear /\srain\s/i, (res) ->
        r = Math.random()
        rain = [
            "There's a 30% chance that it's already raining!",
            "It's like I have ESPN or something. My breasts can always tell when it's going to rain.",
        ]
        if(r > .9 and !recentlyCalled)
            res.send res.random rain
            recentlyCalled = true

    robot.hear /giphy/i, (res) ->
        r = Math.random()

        if(r > p and !recentlyCalled)
            res.send res.random giphies
            recentlyCalled = true

    lulz = ['lol', 'hehe', 'rofl', 'lmao', 'haha']

    robot.hear /lulz|lol|hehe|rofl|lmao|haha|funny/i, (res) ->
        res.send res.random lulz
        recentlyCalled = true

    enterReplies = ['Sup, fellow human?', "What's up with the new guy?", 'Hi!', 'Welcome to the channel, new guy!.']
    leaveReplies = ['EVER SINCE ASIMOV DIED I HAVE ABANDONMENT ISSUES', 'SO LONELY OMG', 'WHY DID YOU LEAVE ME']

    robot.enter (res) ->
        res.send res.random enterReplies
    robot.leave (res) ->
        res.send res.random leaveReplies

